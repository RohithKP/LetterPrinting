<!doctype html>
<head>
<title>Letter Printing</title>
    <style type="text/css" >
        body{
        background-color: beige;
        margin: 0;
        }
        a{
         text-decoration: none;
        }
        #odf{
        background-color: darkgray;
        }
        #list{
        background-color: cadetblue;
        width: 300px;
        float: right;
        position: fixed;
        top: 20px;
        right: 50px;
        z-index: 2;
        color: cornsilk;
        padding: 4px;
        }

        #list h4
        {
        color: azure;
        font-weight: 300;
        }
        #list > a{
            background-color: crimson;
            padding: 5px;
            margin-left: 5px;
            color: azure;
        }
        li a{
            color: floralwhite;
        }
        #tname{
        height: 30px;
        background-color: black;
        color: aliceblue;
        text-align: center;
        text-transform: capitalize;
        padding-top: 10px;
        }
        form a {
        background-color: azure;
        padding: 2px;
        border:0 4px 4px 0;
        }

    </style>
</head>

<body>
<div id="list">
<ul>
    <h4>Available templates</h4>
    {% for t in temp%}
    <li ><a href="#" type="button" value="T" onclick="init('{{t}}')">  {{ t }}</a></li>
    {% endfor %}
</ul>
    <form method="get" action="{{url_for('gen',templatename='')}}" id="gen">
    <input id="templatename" type="hidden" name="templatename" value="" />
    <input id="jsonid"  name="jsonid" value="" min="0" />
    <a id="btn1" type="button" href="#" onclick="submit()"> Try it!</a>
    </form>
    <form method="get" action="{{url_for('wodo')}}" id="wodo">
        <input id="subm" type="hidden" name="tname" value='test_template.odt'>
        <a id="btn2" type="button" href="#" onclick="submit2()"> Edit</a>
    </form>
</div>
    <div id="tname"></div>
    <div id="odf" ></div>

    <script src="{{url_for('static',filename='webodf.js')}}" type="text/javascript" charset="utf-8"></script>

    <script type="text/javascript" charset="utf-8">
     function init(tempname) {
              var odfelement = document.getElementById("odf"),
                  odfcanvas = new odf.OdfCanvas(odfelement);
               document.getElementById("tname").innerHTML = tempname;
                  if(typeof(tempname)=='undefined')
                  {
                     odfcanvas.load("{{url_for('static',filename='odt/test_template.odt')}}");
                     document.getElementById("templatename").value = 'test_template.odt';
                     document.getElementById("subm").value ='test_template.odt';
                     document.getElementById("tname").innerHTML =  'test_template.odt';
                  }
                  else{
                     console.log(tempname);
                     odfcanvas.load("{{url_for('static',filename='odt/')}}"+tempname);
                     document.getElementById("templatename").value =tempname ;
                     document.getElementById("subm").value =tempname ;
                  }
                }
                window.setTimeout(init, 0);
        function submit(){
        document.getElementById("gen").submit();
        }
        function submit2(){
        document.getElementById("wodo").submit();
        }
    </script>
</body>
